<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>منشور هم‌سرنوشتی</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css">
  <style>
    body { font-family: "Tahoma", sans-serif; direction: rtl; }
    
    /* تنظیمات سایدبار راست‌چین استاندارد */
    .sidebar { left: auto !important; right: 0 !important; border-left: 1px solid rgba(0,0,0,.07); border-right: none !important; }
    .content { left: 0 !important; right: 300px !important; }
    .sidebar-toggle { left: auto !important; right: 0 !important; }

    /* هماهنگی با دکمه بستن منو */
    body.close .sidebar { transform: translateX(300px); }
    body.close .content { right: 0 !important; }

    .markdown-section { text-align: right; direction: rtl; padding: 20px 45px; }
    
    @media screen and (max-width: 768px) {
      .content { right: 0 !important; }
      .sidebar { transform: translateX(300px); }
      body.close .sidebar { transform: translateX(0) !important; }
    }
  </style>
</head>
<body>
  <div id="app">در حال بارگذاری...</div>
<script>
 window.$docsify = {
    name: 'منشور هم‌سرنوشتی',
    repo: 'https://github.com/CharterOfIran/Transition-Protocol',
    loadSidebar: true,
    subMaxLevel: 3,
    auto2top: true,
    rtl: true,
    
    // غیرفعال کردن مسیر نسبی برای جلوگیری از تکرار نام پوشه‌ها در سایدبار
    relativePath: false,

plugins: [
      function(hook, vm) {
        hook.beforeEach(function(html) {
          // ۱. استخراج پوشه فعلی از آدرس بار
          const currentPath = vm.route.path;
          const currentDir = currentPath.substring(0, currentPath.lastIndexOf('/') + 1);
          
          // ۲. شناسایی لینک‌های داخلی که به .md ختم می‌شوند
          return html.replace(/\[([^\]]+)\]\((?!http|https|\/)([^)]+)\.md\)/g, function(match, text, path) {
            // حذف ./ از ابتدای لینک اگر وجود داشته باشد
            let cleanPath = path.replace(/^\.\//, '');
            
            // ۳. جادوی اصلی: اگر لینک حاوی .. است، آدرس را از ریشه بازسازی کن
            let finalLink;
            if (cleanPath.startsWith('../')) {
                // اگر لینک به پوشه عقب‌تر می‌رود، اجازه بده خود Docsify مدیریت کند (چون چاره‌ای نیست)
                finalLink = cleanPath + '.md';
            } else {
                // در غیر این صورت، آدرس را مستقیماً به پوشه فعلی بچسبان
                finalLink = currentDir + cleanPath + '.md';
            }
            
            // جلوگیری از تکرار اسلش دوبل //
            finalLink = finalLink.replace(/\/+/g, '/');

            return '[' + text + '](' + finalLink + ')';
          });
        });
      }
    ]
  };
</script>
  <script src="//cdn.jsdelivr.net/npm/docsify@4"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/plugins/search.min.js"></script>
</body>
</html>

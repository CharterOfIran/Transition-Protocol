<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>منشور هم‌سرنوشتی</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css">
  <style>
    body { font-family: "Tahoma", sans-serif; direction: rtl; }
    
    /* تنظیمات سایدبار راست‌چین استاندارد */
    .sidebar { left: auto !important; right: 0 !important; border-left: 1px solid rgba(0,0,0,.07); border-right: none !important; }
    .content { left: 0 !important; right: 300px !important; }
    .sidebar-toggle { left: auto !important; right: 0 !important; }

    /* هماهنگی با دکمه بستن منو */
    body.close .sidebar { transform: translateX(300px); }
    body.close .content { right: 0 !important; }

    .markdown-section { text-align: right; direction: rtl; padding: 20px 45px; }
    
    @media screen and (max-width: 768px) {
      .content { right: 0 !important; }
      .sidebar { transform: translateX(300px); }
      body.close .sidebar { transform: translateX(0) !important; }
    }
  </style>
</head>
<body>
  <div id="app">در حال بارگذاری...</div>
<script>
 window.$docsify = {
    name: 'منشور هم‌سرنوشتی',
    repo: 'https://github.com/CharterOfIran/Transition-Protocol',
    loadSidebar: true,
    subMaxLevel: 3,
    auto2top: true,
    rtl: true,
    
    // غیرفعال کردن مسیر نسبی برای جلوگیری از تکرار نام پوشه‌ها در سایدبار
    relativePath: false,

    plugins: [
      function(hook, vm) {
        // اسکریپت مخصوص اصلاح لینک‌های داخل صفحات (Content Fixer)
        hook.beforeEach(function(html) {
          // پیدا کردن مسیر پوشه فعلی (مثلاً Rapid-Response-72h)
          const currentDir = vm.route.path.split('/').slice(0, -1).join('/');
          
          // اصلاح لینک‌هایی که به .md ختم می‌شوند و مطلق نیستند
          return html.replace(/\[([^\]]+)\]\((?!http|https|\/)([^)]+)\.md\)/g, function(match, text, path) {
            let newPath = path;
            
            // اگر لینک با ./ شروع شده باشد، آن را پاک می‌کنیم
            newPath = newPath.replace(/^\.\//, '');
            
            // ساختن مسیر جدید بر اساس پوشه فعلی
            const finalLink = currentDir + '/' + newPath + '.md';
            
            return '[' + text + '](' + finalLink + ')';
          });
        });
      }
    ]
  };
</script>
  <script src="//cdn.jsdelivr.net/npm/docsify@4"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/plugins/search.min.js"></script>
</body>
</html>
